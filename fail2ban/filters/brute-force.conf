# Fail2Ban brute-force attack filter
# Detects aggressive brute-force patterns

[INCLUDES]
before = common.conf

[Definition]

# General brute-force patterns across different services
failregex = ^%(__prefix_line)s.*authentication failure.*rhost=<HOST>
            ^%(__prefix_line)s.*Failed password for .* from <HOST>
            ^%(__prefix_line)s.*Invalid user .* from <HOST>
            ^%(__prefix_line)s.*Connection reset by <HOST> port \d+
            ^%(__prefix_line)s.*Disconnecting: Too many authentication failures.*\[<HOST>\]
            ^%(__prefix_line)s.*PAM \d+ more authentication failures?.*from <HOST>
            ^%(__prefix_line)s.*PAM: Authentication failure for .* from <HOST>
            ^%(__prefix_line)s.*maximum authentication attempts exceeded.*from <HOST>
            
# HTTP authentication failures
            ^%(__prefix_line)s.*user .* authentication failure.*\[<HOST>\]
            ^%(__prefix_line)s.*401.*<HOST>.*POST
            ^%(__prefix_line)s.*403.*<HOST>.*GET
            
# FTP brute-force
            ^%(__prefix_line)s.*FTP.*Login incorrect.*\[<HOST>\]
            ^%(__prefix_line)s.*FTP.*USER.*530.*<HOST>
            
# Email service brute-force
            ^%(__prefix_line)s.*authentication failed.*\[<HOST>\]
            ^%(__prefix_line)s.*SASL.*authentication failed.*\[<HOST>\]
            
# Database brute-force attempts
            ^%(__prefix_line)s.*Access denied for user.*from host.*<HOST>
            ^%(__prefix_line)s.*authentication failed.*<HOST>

# Generic repeated connection attempts
            ^%(__prefix_line)s.*<HOST>.*repeated

ignoreregex =

[Init]
datepattern = {^LN-BEG}

# Author: Custom IDPS Project
# Description: Generic brute-force attack detection across multiple services
